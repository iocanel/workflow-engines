<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Workflow Engines</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body { 
      font-family: sans-serif; 
      margin: 20px; 
      display: flex;
      gap: 20px;
    }
    .sidebar {
      width: 250px;
      background: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
    }
    .sidebar h2 {
      margin: 0 0 15px 0;
      font-size: 16px;
      color: #333;
      font-weight: bold;
    }
    .content {
      flex: 1;
    }
    .facet-group {
      margin-bottom: 20px;
      margin-left: 10px;
    }
    .facet-group h3 {
      margin: 0 0 10px 0;
      font-size: 14px;
      color: #333;
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .facet-group h3:hover {
      background-color: #e8e8e8;
      border-radius: 3px;
      padding: 2px 4px;
      margin: -2px -4px 8px -4px;
    }
    .collapse-icon {
      font-size: 12px;
      transition: transform 0.2s ease;
    }
    .collapse-icon.collapsed {
      transform: rotate(-90deg);
    }
    .facet-items {
      transition: max-height 0.3s ease;
      overflow: hidden;
    }
    .facet-items.collapsed {
      max-height: 0;
    }
    .facet-item {
      margin: 5px 0;
    }
    .facet-item label {
      font-size: 12px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    .facet-item input {
      margin-right: 8px;
    }
    .results {
      display: grid;
      gap: 15px;
    }
    .result-item {
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background: white;
    }
    .result-item h4 {
      margin: 0 0 10px 0;
      color: #2c5aa0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .result-item h4 a {
      color: #2c5aa0;
      text-decoration: none;
    }
    .result-item h4 a:hover {
      text-decoration: underline;
    }
    .engine-icon {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      object-fit: contain;
    }
    .result-item .field {
      margin: 5px 0;
      font-size: 14px;
    }
    .result-item .field strong {
      color: #555;
    }
    .tag {
      color: #999;
      font-size: 12px;
    }
    .clickable-tag {
      color: #666;
      font-size: 12px;
      cursor: pointer;
      padding: 2px 4px;
      margin: 1px;
      border-radius: 3px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      display: inline-block;
      transition: all 0.2s ease;
    }
    .clickable-tag:hover {
      background-color: #e8e8e8;
      border-color: #ccc;
    }
    .clickable-tag.active {
      background-color: #007bff;
      color: white;
      border-color: #007bff;
    }
    .count {
      color: #666;
      font-size: 11px;
    }
    .tooltip {
      position: relative;
      cursor: help;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 250px;
      background-color: #333;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1000;
      bottom: 125%;
      left: 50%;
      margin-left: -125px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      line-height: 1.4;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>Categorizations</h2>
  <div id="facets"></div>
</div>
<div class="content">
  <h1>Workflow Engines</h1>
  <div style="margin-bottom: 20px;">
    <input type="text" id="searchBox" placeholder="Search workflow engines by name..." style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
  </div>
  <div id="results" class="results"></div>
</div>

<script>
  // Define categorization mappings
  const categorizations = {
    ontological: ["Event", "Process", "Data", "Integration", "Automation"],
    architectural: ["Log", "State-machine", "DAG", "Code flows"],
    teleological: ["Microservice orchestration", "Business process automation", "Data Pipelines", "Integration", "CI/CD", "Machine Learning"],
    structural: ["Code-as-workflow", "DSL", "Graph (DAG)", "YAML", "JSON", "Visual"],
    licensing: ["Free", "OpenSource", "Source-Available", "Proprietary"],
    operational: ["Managed Service", "Self Hosted", "Library"]
  };

  const workflowData = [
    {
      "name": "Temporal",
      "url": "https://temporal.io",
      "icon": "icons/temporal.png",
      "description": "A microservice orchestration platform that guarantees workflow completion even through failures, using event sourcing and deterministic execution.",
      "tags": ["Event", "Log", "Microservice orchestration", "Code-as-workflow", "Persistent", "Replayable", "Event-driven", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Airflow",
      "url": "https://airflow.apache.org",
      "icon": "icons/airflow.png",
      "description": "A platform to programmatically author, schedule and monitor workflows, representing workflows as directed acyclic graphs (DAGs) of tasks.",
      "tags": ["Data", "DAG", "Data Pipelines", "Graph (DAG)", "Ephemeral", "Container", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Camunda (Zeebe)",
      "url": "https://camunda.com",
      "icon": "icons/camunda.png",
      "description": "A cloud-native workflow engine for microservices orchestration, designed for high performance and horizontal scalability with BPMN 2.0 support.",
      "tags": ["Process", "State-machine", "Business process automation", "DSL", "Persistent", "Microservice orchestration", "Cloud-native", "Source-Available", "Self Hosted"]
    },
    {
      "name": "Apache Camel",
      "url": "https://camel.apache.org",
      "icon": "icons/camel.png",
      "description": "A versatile open-source integration framework that empowers you to quickly connect various systems consuming or producing data using Enterprise Integration Patterns.",
      "tags": ["Integration", "Code flows", "DSL", "Ephemeral", "OpenSource", "Library", "Code-as-workflow"]
    },
    {
      "name": "Dagster",
      "url": "https://dagster.io",
      "icon": "icons/dagster.png",
      "description": "A data orchestrator for machine learning, analytics, and ETL that focuses on developer productivity, data quality, and operational simplicity.",
      "tags": ["Data", "DAG", "Data Pipelines", "Code-as-workflow", "Persistent", "Source-Available", "Self Hosted"]
    },
    {
      "name": "Prefect",
      "url": "https://prefect.io",
      "icon": "icons/prefect.png",
      "description": "A workflow orchestration tool empowering developers to build, observe, and react to data pipelines with Python code that's testable, portable, and easy to maintain.",
      "tags": ["Data", "Code flows", "Data Pipelines", "Code-as-workflow", "Ephemeral", "Source-Available", "Self Hosted"]
    },
    {
      "name": "Luigi",
      "url": "https://github.com/spotify/luigi",
      "icon": "icons/luigi.png",
      "description": "A Python module that helps you build complex pipelines of batch jobs with dependency resolution, workflow management, visualization etc.",
      "tags": ["Data", "DAG", "Data Pipelines", "Graph (DAG)", "Ephemeral", "OpenSource", "Library"]
    },
    {
      "name": "Argo Workflows",
      "url": "https://argoproj.github.io/workflows",
      "icon": "icons/argo.png",
      "description": "An open source container-native workflow engine for orchestrating parallel jobs on Kubernetes, implemented as a Kubernetes CRD.",
      "tags": ["Process", "DAG", "CI/CD", "YAML", "Ephemeral", "Kubernetes-native", "Container", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Tekton",
      "url": "https://tekton.dev",
      "icon": "icons/tekton.png",
      "description": "A powerful and flexible open-source framework for creating CI/CD systems, allowing developers to build, test, and deploy across cloud providers and on-premise systems.",
      "tags": ["Process", "Code flows", "CI/CD", "YAML", "Ephemeral", "Kubernetes-native", "Pipeline-as-code", "Container", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Kestra",
      "url": "https://kestra.io",
      "icon": "icons/kestra.png",
      "description": "An infinitely scalable orchestration and scheduling platform, creating, running, scheduling, and monitoring millions of complex pipelines.",
      "tags": ["Data", "DAG", "Data Pipelines", "YAML", "Persistent", "Event-driven", "Kubernetes-native", "Replayable", "Source-Available", "Self Hosted"]
    },
    {
      "name": "Flowable",
      "url": "https://flowable.com",
      "icon": "icons/flowable.png",
      "description": "A compact and highly efficient workflow and Business Process Management (BPM) platform for developers, system admins and business users.",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Activiti",
      "url": "https://www.activiti.org",
      "icon": "icons/activiti.png",
      "description": "A light-weight workflow and Business Process Management (BPM) Platform targeted at business people, developers and system admins.",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine", "OpenSource", "Self Hosted"]
    },
    {
      "name": "jBPM",
      "url": "https://www.jbpm.org",
      "icon": "icons/jbpm.png",
      "description": "A flexible Business Process Management (BPM) suite that allows you to model your business goals by describing the steps that need to be executed to achieve those goals.",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine", "OpenSource", "Self Hosted"]
    },
    {
      "name": "Boomi",
      "url": "https://boomi.com",
      "icon": "icons/boomi.png",
      "description": "A cloud-native, unified, open, and intelligent platform that connects everything and everyone to accelerate business outcomes.",
      "tags": ["Integration", "Code flows", "DSL", "Cloud-native", "Visual", "Event-driven", "Proprietary", "Managed Service"]
    },
    {
      "name": "n8n",
      "url": "https://n8n.io",
      "icon": "icons/n8n.png",
      "description": "A free and source-available workflow automation tool designed for technical people. Easily automate tasks across different services with a visual interface.",
      "tags": ["Automation", "Code flows", "Business process automation", "Event-driven", "Visual", "Source-Available", "Self Hosted"]
    },
    {
      "name": "Make",
      "url": "https://make.com",
      "icon": "icons/make.png",
      "description": "A visual platform that lets you design, build, and automate anything from simple tasks to complex workflows in minutes.",
      "tags": ["Automation", "Code flows", "Business process automation", "Event-driven", "Cloud-native", "Visual", "Ephemeral", "Proprietary", "Managed Service"]
    },
    {
      "name": "Zapier",
      "url": "https://zapier.com",
      "icon": "icons/zapier.png",
      "description": "Easy automation for busy people. Zapier moves info between your web apps automatically, so you can focus on your most important work.",
      "tags": ["Automation", "Code flows", "Business process automation", "Event-driven", "Cloud-native", "Ephemeral", "Proprietary", "Managed Service"]
    },
    {
      "name": "AWS Step Functions",
      "url": "https://aws.amazon.com/step-functions/",
      "icon": "icons/aws-step-functions.png",
      "description": "A visual workflow service that helps developers use AWS services to build distributed applications, automate processes, orchestrate microservices, and create data and machine learning pipelines.",
      "tags": ["Event", "State-machine", "Serverless", "JSON", "Cloud-native", "Event-driven", "Persistent", "Replayable", "Proprietary", "Managed Service"]
    },
    {
      "name": "Azure Logic Apps",
      "url": "https://azure.microsoft.com/en-us/services/logic-apps/",
      "icon": "icons/azure-logic-apps.png",
      "description": "Simplify and scale integration and workflow scenarios in the cloud. Quickly build highly scalable integration solutions for your enterprise and B2B scenarios.",
      "tags": ["Process", "Code flows", "Integration", "Visual", "Cloud-native", "Event-driven", "Serverless", "Persistent", "Proprietary", "Managed Service"]
    },
    {
      "name": "Google Cloud Workflows",
      "url": "https://cloud.google.com/workflows",
      "icon": "icons/google-cloud-workflows.png",
      "description": "Orchestrate and automate Google Cloud and HTTP-based API services with serverless workflows.",
      "tags": ["Event", "Code flows", "Serverless", "YAML", "Cloud-native", "Event-driven", "Ephemeral", "Proprietary", "Managed Service"]
    },
    {
      "name": "Kubeflow Pipelines",
      "url": "https://www.kubeflow.org/docs/components/pipelines/",
      "icon": "icons/kubeflow.png",
      "description": "A platform for building and deploying portable, scalable machine learning (ML) workflows based on Docker containers.",
      "tags": ["Data", "DAG", "Machine Learning", "Code-as-workflow", "Kubernetes-native", "Container", "OpenSource", "Self Hosted"]
    }
  ];

  const facetConfig = [
    {field: 'ontological', display: 'Ontological', description: 'What kind of thing is the engine managing?'},
    {field: 'architectural', display: 'Architectural', description: 'What are the core architectural elements of the engine?'},
    {field: 'teleological', display: 'Teleological', description: 'What is the primary purpose and the goals of the workflow engine?'},
    {field: 'structural', display: 'Structural', description: "What's the structure / format of the workflow?"},
    {field: 'operational', display: 'Operational', description: 'How is the workflow engine deployed and operated?'},
    {field: 'licensing', display: 'Licensing', description: 'What is the licensing model of the workflow engine?'},
    {field: 'other', display: 'Other', description: 'What other traits does the engine have?'}
  ];

  let activeFilters = {};
  let searchQuery = '';

  function buildFacets() {
    // First, filter data based on current filters and search query to get the base set
    let filteredData = workflowData.filter(item => {
      // Check search query first
      if (searchQuery && !item.name.toLowerCase().includes(searchQuery.toLowerCase())) {
        return false;
      }
      
      // Then check facet filters
      return Object.keys(activeFilters).every(field => {
        const filterValues = activeFilters[field];
        
        if (item.tags && Array.isArray(item.tags)) {
          return filterValues.some(filterVal => item.tags.includes(filterVal));
        }
        return false;
      });
    });

    const facetsHtml = facetConfig.map(facet => {
      const values = [];
      
      if (facet.field === 'other') {
        // For "other" category, collect all tags that don't belong to any defined category
        filteredData.forEach(item => {
          if (item.tags && Array.isArray(item.tags)) {
            item.tags.forEach(tag => {
              const belongsToCategory = Object.values(categorizations).some(categoryTags => categoryTags.includes(tag));
              if (!belongsToCategory) {
                if (!values.find(v => v.value === tag)) {
                  values.push({value: tag, count: 1});
                } else {
                  values.find(v => v.value === tag).count++;
                }
              }
            });
          }
        });
      } else {
        // For defined categories, use the categorizations mapping
        const relevantTags = categorizations[facet.field] || [];
        
        filteredData.forEach(item => {
          if (item.tags && Array.isArray(item.tags)) {
            item.tags.forEach(tag => {
              if (relevantTags.includes(tag)) {
                if (!values.find(v => v.value === tag)) {
                  values.push({value: tag, count: 1});
                } else {
                  values.find(v => v.value === tag).count++;
                }
              }
            });
          }
        });
      }

      const facetItems = values.map(val => {
        const isChecked = activeFilters[facet.field] && activeFilters[facet.field].includes(val.value) ? 'checked' : '';
        return `
          <div class="facet-item">
            <label>
              <input type="checkbox" value="${val.value}" data-field="${facet.field}" onchange="updateFilters()" ${isChecked}>
              ${val.value} <span class="count">(${val.count})</span>
            </label>
          </div>
        `;
      }).join('');

      return `
        <div class="facet-group">
          <h3 class="tooltip" onclick="toggleFacet('${facet.field}')">
            <span>${facet.display}
              <span class="tooltiptext">${facet.description}</span>
            </span>
            <span class="collapse-icon" id="icon-${facet.field}">â–¼</span>
          </h3>
          <div class="facet-items" id="items-${facet.field}">
            ${facetItems}
          </div>
        </div>
      `;
    }).join('');

    $('#facets').html(facetsHtml);
  }

  function updateFilters() {
    activeFilters = {};
    $('input[type="checkbox"]:checked').each(function() {
      const field = $(this).data('field');
      const value = $(this).val();
      if (!activeFilters[field]) activeFilters[field] = [];
      activeFilters[field].push(value);
    });
    buildFacets(); // Rebuild facets with updated counts
    displayResults();
  }

  function displayResults() {
    let filteredData = workflowData.filter(item => {
      // Check search query first
      if (searchQuery && !item.name.toLowerCase().includes(searchQuery.toLowerCase())) {
        return false;
      }
      
      // Then check facet filters
      return Object.keys(activeFilters).every(field => {
        const filterValues = activeFilters[field];
        
        if (item.tags && Array.isArray(item.tags)) {
          return filterValues.some(filterVal => item.tags.includes(filterVal));
        }
        return false;
      });
    });

    const resultsHtml = filteredData.map(item => `
      <div class="result-item">
        <h4>
          <img src="${item.icon}" alt="${item.name} icon" class="engine-icon">
          <a href="${item.url}" target="_blank" rel="noopener noreferrer">${item.name}</a>
        </h4>
        <p>${item.description || ''}</p>
        <div class="field"><strong>Tags:</strong> ${item.tags ? item.tags.map(tag => {
          const isActive = Object.values(activeFilters).flat().includes(tag) ? 'active' : '';
          return `<span class="clickable-tag ${isActive}" onclick="toggleTag('${tag}')">#${tag.toLowerCase()}</span>`;
        }).join(' ') : ''}</div>
      </div>
    `).join('');

    $('#results').html(resultsHtml);
  }

  function toggleFacet(fieldName) {
    const items = document.getElementById(`items-${fieldName}`);
    const icon = document.getElementById(`icon-${fieldName}`);
    
    if (items.classList.contains('collapsed')) {
      items.classList.remove('collapsed');
      icon.classList.remove('collapsed');
      items.style.maxHeight = items.scrollHeight + 'px';
    } else {
      items.classList.add('collapsed');
      icon.classList.add('collapsed');
      items.style.maxHeight = '0px';
    }
  }

  function updateSearch() {
    searchQuery = $('#searchBox').val().trim();
    buildFacets();
    displayResults();
  }

  function toggleTag(tagValue) {
    // Find which category this tag belongs to
    let targetField = null;
    
    // Check defined categories first
    for (const [field, tags] of Object.entries(categorizations)) {
      if (tags.includes(tagValue)) {
        targetField = field;
        break;
      }
    }
    
    // If not found in defined categories, it belongs to "other"
    if (!targetField) {
      targetField = 'other';
    }
    
    // Find the corresponding checkbox and toggle it
    const checkbox = $(`input[type="checkbox"][value="${tagValue}"][data-field="${targetField}"]`);
    if (checkbox.length > 0) {
      checkbox.prop('checked', !checkbox.prop('checked'));
      updateFilters();
    }
  }

  // Initialize
  $(document).ready(function() {
    buildFacets();
    displayResults();
    
    // Add search box event listener
    $('#searchBox').on('input', updateSearch);
    
    // Set initial max-height for smooth transitions
    setTimeout(() => {
      $('.facet-items').each(function() {
        if (!$(this).hasClass('collapsed')) {
          $(this).css('max-height', this.scrollHeight + 'px');
        }
      });
    }, 100);
  });
</script>

</body>
</html>
