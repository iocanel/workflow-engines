<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Workflow Engines</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body { 
      font-family: sans-serif; 
      margin: 20px; 
      display: flex;
      gap: 20px;
    }
    .sidebar {
      width: 250px;
      background: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
    }
    .sidebar h2 {
      margin: 0 0 15px 0;
      font-size: 16px;
      color: #333;
      font-weight: bold;
    }
    .content {
      flex: 1;
    }
    .facet-group {
      margin-bottom: 20px;
      margin-left: 10px;
    }
    .facet-group h3 {
      margin: 0 0 10px 0;
      font-size: 14px;
      color: #333;
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .facet-group h3:hover {
      background-color: #e8e8e8;
      border-radius: 3px;
      padding: 2px 4px;
      margin: -2px -4px 8px -4px;
    }
    .collapse-icon {
      font-size: 12px;
      transition: transform 0.2s ease;
    }
    .collapse-icon.collapsed {
      transform: rotate(-90deg);
    }
    .facet-items {
      transition: max-height 0.3s ease;
      overflow: hidden;
    }
    .facet-items.collapsed {
      max-height: 0;
    }
    .facet-item {
      margin: 5px 0;
    }
    .facet-item label {
      font-size: 12px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    .facet-item input {
      margin-right: 8px;
    }
    .results {
      display: grid;
      gap: 15px;
    }
    .result-item {
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background: white;
    }
    .result-item h4 {
      margin: 0 0 10px 0;
      color: #2c5aa0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .result-item h4 a {
      color: #2c5aa0;
      text-decoration: none;
    }
    .result-item h4 a:hover {
      text-decoration: underline;
    }
    .engine-icon {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      object-fit: contain;
    }
    .result-item .field {
      margin: 5px 0;
      font-size: 14px;
    }
    .result-item .field strong {
      color: #555;
    }
    .tag {
      color: #999;
      font-size: 12px;
    }
    .count {
      color: #666;
      font-size: 11px;
    }
    .tooltip {
      position: relative;
      cursor: help;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 250px;
      background-color: #333;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1000;
      bottom: 125%;
      left: 50%;
      margin-left: -125px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      line-height: 1.4;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>Categorizations</h2>
  <div id="facets"></div>
</div>
<div class="content">
  <h1>Workflow Engines</h1>
  <div id="results" class="results"></div>
</div>

<script>
  // Define categorization mappings
  const categorizations = {
    ontological: ["Event", "Process", "Data", "Integration", "Automation"],
    architectural: ["Log", "State-machine", "DAG", "Code flows"],
    teleological: ["Microservice orchestration", "Business process automation", "Data Pipelines", "Integration", "CI/CD", "Machine Learning"],
    structural: ["Code-as-workflow", "DSL", "Graph (DAG)", "YAML", "Node flows", "Rule automation", "JSON", "Visual workflow design"]
  };

  const workflowData = [
    {
      "name": "Temporal",
      "url": "https://temporal.io",
      "icon": "icons/temporal.png",
      "tags": ["Event", "Log", "Microservice orchestration", "Code-as-workflow", "Persistent", "Replayable"]
    },
    {
      "name": "Airflow",
      "url": "https://airflow.apache.org",
      "icon": "icons/airflow.png",
      "tags": ["Data", "DAG", "Data Pipelines", "Graph (DAG)", "Ephemeral"]
    },
    {
      "name": "Camunda (Zeebe)",
      "url": "https://camunda.com",
      "icon": "icons/camunda.png",
      "tags": ["Process", "State-machine", "Business process automation", "DSL", "Persistent", "Microservice orchestration"]
    },
    {
      "name": "Apache Camel",
      "url": "https://camel.apache.org",
      "icon": "icons/camel.png",
      "tags": ["Integration", "Code flows", "DSL", "Ephemeral", "Mutable"]
    },
    {
      "name": "Dagster",
      "url": "https://dagster.io",
      "icon": "icons/dagster.png",
      "tags": ["Data", "DAG", "Data Pipelines", "Code-as-workflow", "Persistent", "Type-aware"]
    },
    {
      "name": "Prefect",
      "url": "https://prefect.io",
      "icon": "icons/prefect.png",
      "tags": ["Data", "Code flows", "Data Pipelines", "Code-as-workflow", "Ephemeral", "Dynamic orchestration"]
    },
    {
      "name": "Luigi",
      "url": "https://github.com/spotify/luigi",
      "icon": "icons/luigi.png",
      "tags": ["Data", "DAG", "Data Pipelines", "Graph (DAG)", "Ephemeral"]
    },
    {
      "name": "Argo Workflows",
      "url": "https://argoproj.github.io/workflows",
      "icon": "icons/argo.png",
      "tags": ["Process", "DAG", "CI/CD", "YAML", "Ephemeral", "Kubernetes-native", "Container"]
    },
    {
      "name": "Tekton",
      "url": "https://tekton.dev",
      "icon": "icons/tekton.png",
      "tags": ["Process", "Code flows", "CI/CD", "YAML", "Ephemeral", "Kubernetes-native", "Pipeline-as-code", "Container"]
    },
    {
      "name": "Kestra",
      "url": "https://kestra.io",
      "icon": "icons/kestra.png",
      "tags": ["Data", "DAG", "Data Pipelines", "YAML", "Persistent", "Event-driven"]
    },
    {
      "name": "Flowable",
      "url": "https://flowable.com",
      "icon": "icons/flowable.png",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine"]
    },
    {
      "name": "Activiti",
      "url": "https://www.activiti.org",
      "icon": "icons/activiti.png",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine"]
    },
    {
      "name": "jBPM",
      "url": "https://www.jbpm.org",
      "icon": "icons/jbpm.png",
      "tags": ["Process", "DAG", "Business process automation", "DSL", "Persistent", "State-machine"]
    },
    {
      "name": "Boomi",
      "url": "https://boomi.com",
      "icon": "icons/boomi.png",
      "tags": ["Integration", "Code flows", "DSL", "Cloud-native", "Managed service", "Visual workflow design"]
    },
    {
      "name": "n8n",
      "url": "https://n8n.io",
      "icon": "icons/n8n.png",
      "tags": ["Automation", "Code flows", "Business process automation", "Node flows", "Event-driven", "Self-hosted", "Visual workflow design"]
    },
    {
      "name": "Make",
      "url": "https://make.com",
      "icon": "icons/make.png",
      "tags": ["Automation", "Code flows", "Business process automation", "Node flows", "Event-driven", "Cloud-native", "Visual workflow design"]
    },
    {
      "name": "Zapier",
      "url": "https://zapier.com",
      "icon": "icons/zapier.png",
      "tags": ["Automation", "Code flows", "Business process automation", "Rule automation", "Event-driven", "Cloud-native", "Trigger-action flows"]
    },
    {
      "name": "AWS Step Functions",
      "url": "https://aws.amazon.com/step-functions/",
      "icon": "icons/aws-step-functions.png",
      "tags": ["Event", "State-machine", "Serverless", "JSON", "Cloud-native", "Managed service", "Event-driven"]
    },
    {
      "name": "Azure Logic Apps",
      "url": "https://azure.microsoft.com/en-us/services/logic-apps/",
      "icon": "icons/azure-logic-apps.png",
      "tags": ["Process", "Code flows", "Integration", "Visual workflow design", "Cloud-native", "Managed service", "Event-driven"]
    },
    {
      "name": "Google Cloud Workflows",
      "url": "https://cloud.google.com/workflows",
      "icon": "icons/google-cloud-workflows.png",
      "tags": ["Event", "Code flows", "Serverless", "YAML", "Cloud-native", "Managed service", "Event-driven"]
    },
    {
      "name": "Kubeflow Pipelines",
      "url": "https://www.kubeflow.org/docs/components/pipelines/",
      "icon": "icons/kubeflow.png",
      "tags": ["Data", "DAG", "Machine Learning", "Code-as-workflow", "Kubernetes-native", "Experiment tracking"]
    }
  ];

  const facetConfig = [
    {field: 'ontological', display: 'Ontological', description: 'What kind of thing is the engine managing?'},
    {field: 'architectural', display: 'Architectural', description: 'What are the core architectural elements of the engine?'},
    {field: 'teleological', display: 'Teleological', description: 'What is the primary purpose and the goals of the workflow engine?'},
    {field: 'structural', display: 'Structural', description: "What's the structure / format of the workflow?"},
    {field: 'other', display: 'Other', description: 'What other traits does the engine have?'}
  ];

  let activeFilters = {};

  function buildFacets() {
    const facetsHtml = facetConfig.map(facet => {
      const values = [];
      
      if (facet.field === 'other') {
        // For "other" category, collect all tags that don't belong to any defined category
        workflowData.forEach(item => {
          if (item.tags && Array.isArray(item.tags)) {
            item.tags.forEach(tag => {
              const belongsToCategory = Object.values(categorizations).some(categoryTags => categoryTags.includes(tag));
              if (!belongsToCategory) {
                if (!values.find(v => v.value === tag)) {
                  values.push({value: tag, count: 1});
                } else {
                  values.find(v => v.value === tag).count++;
                }
              }
            });
          }
        });
      } else {
        // For defined categories, use the categorizations mapping
        const relevantTags = categorizations[facet.field] || [];
        
        workflowData.forEach(item => {
          if (item.tags && Array.isArray(item.tags)) {
            item.tags.forEach(tag => {
              if (relevantTags.includes(tag)) {
                if (!values.find(v => v.value === tag)) {
                  values.push({value: tag, count: 1});
                } else {
                  values.find(v => v.value === tag).count++;
                }
              }
            });
          }
        });
      }

      const facetItems = values.map(val => `
        <div class="facet-item">
          <label>
            <input type="checkbox" value="${val.value}" data-field="${facet.field}" onchange="updateFilters()">
            ${val.value} <span class="count">(${val.count})</span>
          </label>
        </div>
      `).join('');

      return `
        <div class="facet-group">
          <h3 class="tooltip" onclick="toggleFacet('${facet.field}')">
            <span>${facet.display}
              <span class="tooltiptext">${facet.description}</span>
            </span>
            <span class="collapse-icon" id="icon-${facet.field}">▼</span>
          </h3>
          <div class="facet-items" id="items-${facet.field}">
            ${facetItems}
          </div>
        </div>
      `;
    }).join('');

    $('#facets').html(facetsHtml);
  }

  function updateFilters() {
    activeFilters = {};
    $('input[type="checkbox"]:checked').each(function() {
      const field = $(this).data('field');
      const value = $(this).val();
      if (!activeFilters[field]) activeFilters[field] = [];
      activeFilters[field].push(value);
    });
    displayResults();
  }

  function displayResults() {
    let filteredData = workflowData.filter(item => {
      return Object.keys(activeFilters).every(field => {
        const filterValues = activeFilters[field];
        
        if (item.tags && Array.isArray(item.tags)) {
          return filterValues.some(filterVal => item.tags.includes(filterVal));
        }
        return false;
      });
    });

    const resultsHtml = filteredData.map(item => `
      <div class="result-item">
        <h4>
          <img src="${item.icon}" alt="${item.name} icon" class="engine-icon">
          <a href="${item.url}" target="_blank" rel="noopener noreferrer">${item.name}</a>
        </h4>
        <div class="field"><strong>Tags:</strong> <span class="tag">${item.tags ? item.tags.map(tag => '#' + tag.toLowerCase()).join(' ') : ''}</span></div>
      </div>
    `).join('');

    $('#results').html(resultsHtml);
  }

  function toggleFacet(fieldName) {
    const items = document.getElementById(`items-${fieldName}`);
    const icon = document.getElementById(`icon-${fieldName}`);
    
    if (items.classList.contains('collapsed')) {
      items.classList.remove('collapsed');
      icon.classList.remove('collapsed');
      items.style.maxHeight = items.scrollHeight + 'px';
    } else {
      items.classList.add('collapsed');
      icon.classList.add('collapsed');
      items.style.maxHeight = '0px';
    }
  }

  // Initialize
  $(document).ready(function() {
    buildFacets();
    displayResults();
    
    // Set initial max-height for smooth transitions
    setTimeout(() => {
      $('.facet-items').each(function() {
        if (!$(this).hasClass('collapsed')) {
          $(this).css('max-height', this.scrollHeight + 'px');
        }
      });
    }, 100);
  });
</script>

</body>
</html>
